<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recetas | Paso a paso</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;800&family=Playfair+Display:ital,wght@0,700;1,700&display=swap" rel="stylesheet">
    <link rel="icon" href="/image/icon.ico">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root { --orange-main: #f97316; }
        body { font-family: 'Plus Jakarta Sans', sans-serif; background-color: #f8fafc; overflow-x: hidden; }
        .font-serif { font-family: 'Playfair Display', serif; }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        /* Estilos Swiper */
        .swiper { padding: 20px 5px 50px 5px !important; }
        
        /* Efectos de Cristal y Tarjetas */
        .premium-card {
            background: rgba(255, 255, 255, 1);
            transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);
            position: relative;
            overflow: hidden;
        }
        .premium-card::before {
            content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: 0.5s;
        }
        .premium-card:hover::before { left: 100%; }
        .premium-card:hover { transform: translateY(-12px); box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.1); }

        .category-pill {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid #e2e8f0;
        }
        .category-pill.active { background: #000; color: #fff; border-color: #000; transform: scale(1.05); }

        .hidden-section { display: none; opacity: 0; }
        .visible-section { display: block; animation: fadeIn 0.8s ease forwards; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Glassmorphism Nav */
        nav { border-bottom: 1px solid rgba(0,0,0,0.05); }
    </style>
</head>
<body class="text-slate-900">

    <nav class="fixed top-0 w-full z-[100] bg-white/80 backdrop-blur-2xl transition-all duration-300" id="mainNav">
        <div class="max-w-7xl mx-auto px-6 h-20 flex justify-between items-center">
            <div class="flex items-center gap-3 group cursor-pointer" onclick="location.reload()">
                <div class="bg-orange-500 p-2.5 rounded-2xl group-hover:rotate-[360deg] transition-transform duration-700 shadow-lg shadow-orange-200">
                    <i data-lucide="chef-hat" class="text-white w-6 h-6"></i>
                </div>
                <span class="text-2xl font-extrabold tracking-tighter">Receta<span class="text-orange-500 italic">Pp</span></span>
            </div>
            
            <div class="hidden lg:flex gap-10 text-[13px] font-bold uppercase tracking-[0.2em] text-slate-500">
                <a href="#lo-ultimo" class="hover:text-orange-500 transition-colors relative group">Temporada <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-orange-500 transition-all group-hover:w-full"></span></a>
                <a href="#seccion-fit" class="hover:text-orange-500 transition-colors relative group">Fitness <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-orange-500 transition-all group-hover:w-full"></span></a>
                <a href="#seccion-postres" class="hover:text-orange-500 transition-colors relative group">Dulce <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-orange-500 transition-all group-hover:w-full"></span></a>
                <a href="#paises" class="hover:text-orange-500 transition-colors relative group">Global <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-orange-500 transition-all group-hover:w-full"></span></a>
            </div>

            <button onclick="lanzarConfetti()" class="group bg-slate-900 text-white px-7 py-3 rounded-full text-sm font-bold hover:bg-orange-600 transition-all duration-300 shadow-xl hover:shadow-orange-200 flex items-center gap-2">
                <span>Sugerir</span>
                <i data-lucide="sparkles" class="w-4 h-4 group-hover:animate-pulse"></i>
            </button>
        </div>
    </nav>

    <header class="pt-40 pb-16 px-6 max-w-7xl mx-auto">
        <div class="grid lg:grid-cols-2 gap-16 items-center">
            <div data-aos="fade-right">
                <div class="flex items-center gap-2 mb-6">
                    <span class="h-px w-8 bg-orange-500"></span>
                    <span class="text-orange-600 text-xs font-black uppercase tracking-[0.3em]">Culinaria del Futuro</span>
                </div>
                <h1 class="text-7xl md:text-8xl font-serif leading-[0.9] mb-10">Tu paladar <br><span class="italic text-orange-500">sin límites.</span></h1>
                
                <div class="relative max-w-xl group">
                    <div class="absolute -inset-2 bg-gradient-to-r from-orange-500 to-pink-500 rounded-[2.5rem] opacity-20 blur group-focus-within:opacity-40 transition duration-500"></div>
                    <div class="relative bg-white rounded-3xl shadow-2xl flex items-center p-2">
                        <i data-lucide="search" class="ml-5 text-slate-400"></i>
                        <input type="text" id="searchInput" placeholder="Ingrediente, país o estilo..." 
                               class="w-full px-5 py-4 outline-none text-lg bg-transparent">
                        <button class="bg-orange-500 text-white p-4 rounded-2xl hover:bg-slate-900 transition-colors shadow-lg">
                            <i data-lucide="arrow-right"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="hidden lg:block relative" data-aos="zoom-in">
                <div class="absolute -inset-10 bg-orange-100 rounded-full blur-[100px] opacity-60 animate-pulse"></div>
                <img src="https://images.unsplash.com/photo-1504674900247-0877df9cc836?q=80&w=2070" 
                     class="relative rounded-[4rem] shadow-3xl h-[550px] w-full object-cover transform rotate-2 hover:rotate-0 transition-transform duration-700">
            </div>
        </div>

        <div id="category-bar" class="flex gap-4 overflow-x-auto py-12 no-scrollbar" data-aos="fade-up" data-aos-delay="200">
            </div>
    </header>

    <main class="max-w-7xl mx-auto px-6 pb-32 space-y-40">

        <section id="search-section" class="hidden-section">
            <div class="flex items-end justify-between mb-12">
                <h2 class="text-4xl font-serif">Resultados Encontrados</h2>
                <button onclick="location.reload()" class="text-orange-500 font-bold flex items-center gap-2">Limpiar <i data-lucide="x" class="w-4 h-4"></i></button>
            </div>
            <div id="search-results" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-10"></div>
        </section>

        <section id="main-content" class="space-y-40">
            
            <section id="lo-ultimo" data-aos="fade-up">
                <div class="flex items-end justify-between mb-10">
                    <div>
                        <h2 class="text-5xl font-serif mb-4">Selección del Chef</h2>
                        <p class="text-slate-400 text-lg">Las recetas más populares esta semana.</p>
                    </div>
                </div>
                <div class="swiper seasonSwiper">
                    <div class="swiper-wrapper" id="grid-general"></div>
                    <div class="swiper-pagination"></div>
                </div>
            </section>

            <section id="seccion-fit" class="bg-slate-950 rounded-[4rem] p-10 lg:p-20 overflow-hidden relative" data-aos="fade-up">
                <div class="absolute top-0 right-0 w-96 h-96 bg-emerald-500/20 blur-[120px] rounded-full"></div>
                <div class="relative z-10 grid lg:grid-cols-3 gap-16 items-center">
                    <div class="lg:col-span-1">
                        <span class="bg-emerald-500 text-white px-4 py-1 rounded-full text-[10px] font-black uppercase tracking-widest">Healthy Mastery</span>
                        <h2 class="text-5xl font-serif text-white mt-6 mb-8 leading-tight">Cuerpo sano, <br><span class="text-emerald-400 italic">mente fuerte.</span></h2>
                        <p class="text-slate-400 text-lg mb-10">Alta cocina nutricional diseñada para optimizar tu rendimiento diario.</p>
                    </div>
                    <div id="grid-fit" class="lg:col-span-2 grid md:grid-cols-2 gap-8"></div>
                </div>
            </section>

            <section id="seccion-postres" data-aos="fade-up">
                <div class="bg-rose-50 rounded-[4rem] p-16">
                    <div class="text-center max-w-2xl mx-auto mb-16">
                        <h2 class="text-5xl font-serif mb-6">Tentación Infinita</h2>
                        <p class="text-rose-400 font-bold uppercase tracking-widest text-sm">Pâtisserie & Confectionery</p>
                    </div>
                    <div id="grid-postres" class="grid grid-cols-1 md:grid-cols-3 gap-10"></div>
                </div>
            </section>

        </section>
    </main>

    <footer class="bg-white border-t border-slate-100 pt-24 pb-12 px-6">
        <div class="max-w-7xl mx-auto grid md:grid-cols-4 gap-12 mb-20">
            <div class="col-span-2">
                <span class="text-3xl font-black tracking-tighter mb-6 block">RecetaPp</span>
                <p class="text-slate-400 text-lg max-w-sm">Redefiniendo la forma en que el mundo descubre la cocina a través de inteligencia colectiva.</p>
            </div>
            <div>
                <h4 class="font-bold mb-6">Explorar</h4>
                <ul class="space-y-4 text-slate-500">
                    <li><a href="#" class="hover:text-orange-500 transition">Recetas Pro</a></li>
                    <li><a href="#" class="hover:text-orange-500 transition">Cursos Online</a></li>
                    <li><a href="#" class="hover:text-orange-500 transition">Ingredientes</a></li>
                </ul>
            </div>
            <div>
                <h4 class="font-bold mb-6">Comunidad</h4>
                <div class="flex gap-4">
                    <div class="w-12 h-12 bg-slate-50 rounded-2xl flex items-center justify-center hover:bg-orange-500 hover:text-white transition-all cursor-pointer"><i data-lucide="instagram"></i></div>
                    <div class="w-12 h-12 bg-slate-50 rounded-2xl flex items-center justify-center hover:bg-orange-500 hover:text-white transition-all cursor-pointer"><i data-lucide="youtube"></i></div>
                </div>
            </div>
        </div>
        <div class="max-w-7xl mx-auto pt-8 border-t border-slate-50 text-center text-slate-400 text-sm">
            &copy; 2026 RecetaPp | Todos los derechos reservados.
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <script>
        let todasRecetas = [];
        const categorias = [
            {n: "Snacks", i: "sandwich"},
            {n: "Almuerzo", i: "utensils"},
            {n: "Fit", i: "zap"},
            {n: "Saludable", i: "heart"},
            {n: "Postre", i: "cake"},
            {n: "Desayuno", i: "coffee"},
            {n: "Vegano", i: "leaf"},
            {n: "Mariscos", i: "fish"},
            {n: "Cena", i: "moon"}
        ];

        // Inicialización
        AOS.init({ duration: 1000, once: true });

        function lanzarConfetti() {
            confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 }, colors: ['#f97316', '#fbbf24', '#000000'] });
        }

        function cardHTML(r, variant = 'standard') {
    const id = r.video_id || r.video_original_id;
    // Aprovechamos los datos del JSON o ponemos valores por defecto si no existen
    const tiempo = r.tiempo || "20 min";
    const dificultad = r.dificultad || "Fácil";
    const popularidad = r.popularidad || 4.5;
    const calorias = r.calorias ? `<span class="flex items-center gap-1"><i data-lucide="flame" class="w-3 h-3 text-orange-500"></i>${r.calorias}</span>` : "";

    const cardMarkup = `
        <div class="premium-card rounded-[2.5rem] shadow-sm h-full group/card bg-white cursor-pointer" onclick="window.location.href='receta.html?id=${id}'">
            <div class="relative overflow-hidden aspect-[4/5]">
                <img src="https://img.youtube.com/vi/${id}/maxresdefault.jpg" 
                     class="w-full h-full object-cover transition-transform duration-700 group-hover/card:scale-110"
                     onerror="this.src='https://img.youtube.com/vi/${id}/hqdefault.jpg'">
                
                <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-transparent to-transparent opacity-0 group-hover/card:opacity-100 transition-opacity duration-500"></div>
                
                <div class="absolute top-6 left-6 bg-white/95 backdrop-blur px-4 py-1.5 rounded-2xl text-[10px] font-black uppercase tracking-[0.2em] text-slate-900 shadow-xl">
                    ${r.pais || 'Global'}
                </div>

                ${popularidad >= 4.8 ? `
                <div class="absolute top-6 right-6 bg-orange-500 text-white px-3 py-1.5 rounded-2xl text-[9px] font-black uppercase tracking-tighter shadow-lg">
                    Top Recipe
                </div>` : ''}
            </div>

            <div class="p-8">
                <div class="flex items-center justify-between mb-3">
                    <div class="flex items-center gap-2">
                        <span class="w-2 h-2 rounded-full bg-orange-500 animate-pulse"></span>
                        <span class="text-[10px] font-bold uppercase tracking-widest text-slate-400">${r.categoria}</span>
                    </div>
                    <div class="text-[10px] font-bold text-slate-400 flex items-center gap-1">
                        <i data-lucide="star" class="w-3 h-3 fill-orange-500 text-orange-500"></i>
                        ${popularidad}
                    </div>
                </div>

                <h4 class="font-bold text-xl leading-tight mb-4 group-hover/card:text-orange-500 transition-colors line-clamp-2">${r.titulo}</h4>
                
                <div class="flex items-center justify-between pt-4 border-t border-slate-50">
                    <div class="flex flex-wrap gap-4 text-slate-400">
                        <div class="flex items-center gap-1.5 text-[11px] font-bold uppercase tracking-tight">
                            <i data-lucide="timer" class="w-4 h-4 text-orange-500"></i>
                            <span>${tiempo}</span>
                        </div>
                        <div class="flex items-center gap-1.5 text-[11px] font-bold uppercase tracking-tight">
                            <i data-lucide="bar-chart" class="w-4 h-4 text-orange-500"></i>
                            <span>${dificultad}</span>
                        </div>
                    </div>
                    
                    <div class="w-10 h-10 rounded-full bg-slate-50 flex items-center justify-center group-hover/card:bg-orange-500 group-hover/card:text-white transition-all shadow-sm">
                        <i data-lucide="chevron-right" class="w-5 h-5"></i>
                    </div>
                </div>
                
                <div class="mt-3 text-[10px] font-medium text-slate-400">
                    ${calorias}
                </div>
            </div>
        </div>`;

    return variant === 'standard' ? `<div class="swiper-slide h-auto">${cardMarkup}</div>` : cardMarkup;
}

        async function cargar() {
    try {
        //const res = await fetch('./data/recetas.json');
        //todasRecetas = await res.json();
        const workerUrl = 'https://api-recetas.carlosmanuelamparo2830.workers.dev'; 
        const res = await fetch(workerUrl);
        
        // El Worker está configurado para que, si no hay ID, mande el resumen
        todasRecetas = await res.json();

        // Render Categorías
        const catBar = document.getElementById('category-bar');
        catBar.innerHTML = categorias.map(c => `
            <button onclick="filtrarPorCat('${c.n}', this)" class="category-pill flex items-center gap-3 px-8 py-4 bg-white rounded-3xl shadow-sm whitespace-nowrap font-bold text-sm hover:shadow-xl hover:-translate-y-1">
                <i data-lucide="${c.i}" class="w-4 h-4 text-orange-500"></i>
                ${c.n}
            </button>
        `).join('');

        // --- LÓGICA DE ALEATORIEDAD PARA TODAS LAS SECCIONES ---

        // 1. Selección del Chef (Cualquier receta al azar)
        /*const recetasChef = [...todasRecetas]
            .sort(() => Math.random() - 0.5)
            .slice(0, 8);
        render(recetasChef, 'grid-general', 'standard');*/
        // 2. Sección Fit y Saludable (Mezcladas al azar)
        const recetasSaludablesYFit = todasRecetas
            .filter(r => {
                const cat = r.categoria?.toLowerCase() || "";
                // Retorna verdadero si la categoría contiene "fit" O contiene "saludable"
                return cat.includes('fit') || cat.includes('saludable');
            })
            .sort(() => Math.random() - 0.5) // Mezcla ambos tipos de recetas
            .slice(0, 2); // Toma 2 para mantener el diseño de la cuadrícula
        
        render(recetasSaludablesYFit, 'grid-fit', 'fit');


        // 2. Sección Fit (Solo categoría Fit al azar)
        const recetasFit = todasRecetas
            .filter(r => r.categoria?.toLowerCase().includes('fit', ('fit')))
            .sort(() => Math.random() - 0.5) // Mezclamos los resultados filtrados
            .slice(0, 2);
        render(recetasFit, 'grid-fit', 'fit');

        // 3. Sección Postres (Solo categoría Postre al azar)
        const recetasPostres = todasRecetas
            .filter(r => r.categoria?.toLowerCase().includes('postre'))
            .sort(() => Math.random() - 0.5) // Mezclamos los resultados filtrados
            .slice(0, 3);
        render(recetasPostres, 'grid-postres', 'postre');

        // Reiniciar iconos de Lucide para las nuevas tarjetas
        lucide.createIcons();

        // Iniciar Swiper
        new Swiper(".seasonSwiper", {
            slidesPerView: 1, 
            spaceBetween: 30,
            pagination: { el: ".swiper-pagination", clickable: true },
            breakpoints: { 
                640: { slidesPerView: 2 }, 
                1024: { slidesPerView: 3.5 } 
            }
        });

    } catch (e) { 
        console.error("Error cargando recetas:", e); 
    }
}

        function render(lista, elementId, variant) {
    const el = document.getElementById(elementId);
    if (!el) return;

    // Si es la sección de búsqueda, usamos un grid layout, no swiper-slides
    if (variant === 'grid') {
        el.innerHTML = lista.map(r => cardHTML(r, 'grid')).join('');
    } else {
        el.innerHTML = lista.map(r => cardHTML(r, variant)).join('');
    }
    
    lucide.createIcons();
}

        function filtrarPorCat(cat, btn) {
            document.querySelectorAll('.category-pill').forEach(p => p.classList.remove('active'));
            if(btn) btn.classList.add('active');
            ejecutarBusqueda(cat);
        }

        function ejecutarBusqueda(term) {
            const resultsGrid = document.getElementById('search-results');
            const searchSection = document.getElementById('search-section');
            const mainContent = document.getElementById('main-content');

            if (term.length > 2) {
                const results = todasRecetas.filter(r => 
                    r.titulo.toLowerCase().includes(term.toLowerCase()) || 
                    r.categoria?.toLowerCase().includes(term.toLowerCase())
                ).slice(0, 20);

                mainContent.classList.add('hidden-section');
                searchSection.classList.add('visible-section');
                searchSection.classList.remove('hidden-section');
                render(results, 'search-results', 'grid');
            } else {
                mainContent.classList.remove('hidden-section');
                searchSection.classList.add('hidden-section');
            }
        }

        document.getElementById('searchInput').addEventListener('input', (e) => ejecutarBusqueda(e.target.value));
        
        // Efecto scroll nav
        window.onscroll = () => {
            const nav = document.getElementById('mainNav');
            if (window.scrollY > 50) nav.classList.add('py-4', 'shadow-xl');
            else nav.classList.remove('py-4', 'shadow-xl');
        };

        window.onload = cargar;
    </script>
</body>
</html>